(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    159349,       4454]
NotebookOptionsPosition[    149512,       4294]
NotebookOutlinePosition[    149904,       4310]
CellTagsIndexPosition[    149861,       4307]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8479293362798653`*^9, 3.847929337356419*^9}},
 CellLabel->
  "In[207]:=",ExpressionUUID->"bd0b2cf0-3f9a-4432-9e51-1cb39d5226b0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"R\[Theta]kT", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]k", "]"}], ",", "0", ",", 
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Theta]k", "]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]k", "]"}], ",", "0", ",", 
       RowBox[{"Cos", "[", "\[Theta]k", "]"}]}], "}"}]}], "}"}]}], ";", 
  RowBox[{"R\[Theta]kT", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R\[Phi]kT", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], ",", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
  RowBox[{"R\[Phi]kT", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R\[Phi]k", "=", 
   RowBox[{"Transpose", "[", "R\[Phi]kT", "]"}]}], ";", 
  RowBox[{"R\[Phi]k", "//", "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.8473620663312473`*^9, 3.847362138764655*^9}, {
  3.84740136590833*^9, 3.847401401278686*^9}, {3.847929321878109*^9, 
  3.847929360227685*^9}, {3.848368614234967*^9, 3.848368649906918*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"fd8d32e2-783a-4b87-a6da-07e4c9659bed"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Theta]k", "]"}], "0", 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Theta]k", "]"}]}]},
     {"0", "1", "0"},
     {
      RowBox[{"Sin", "[", "\[Theta]k", "]"}], "0", 
      RowBox[{"Cos", "[", "\[Theta]k", "]"}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.847362108976933*^9, 3.847362139253398*^9, {3.847401374674265*^9, 
   3.847401402011497*^9}, 3.847413823840329*^9, 3.847929363664743*^9, 
   3.848368082939981*^9, {3.848368629062455*^9, 3.848368650216042*^9}},
 CellLabel->
  "Out[25]//MatrixForm=",ExpressionUUID->"8015f19a-5da3-4569-89df-\
1f15797fc7a7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Phi]k", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}], "0"},
     {
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.847362108976933*^9, 3.847362139253398*^9, {3.847401374674265*^9, 
   3.847401402011497*^9}, 3.847413823840329*^9, 3.847929363664743*^9, 
   3.848368082939981*^9, {3.848368629062455*^9, 3.848368650218226*^9}},
 CellLabel->
  "Out[26]//MatrixForm=",ExpressionUUID->"cb3e86cf-c6fa-469d-b4a8-\
8c3df184c098"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[Phi]k", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "\[Phi]k", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.847362108976933*^9, 3.847362139253398*^9, {3.847401374674265*^9, 
   3.847401402011497*^9}, 3.847413823840329*^9, 3.847929363664743*^9, 
   3.848368082939981*^9, {3.848368629062455*^9, 3.848368650220191*^9}},
 CellLabel->
  "Out[27]//MatrixForm=",ExpressionUUID->"62b278b4-5ba8-4d05-9478-\
501023cac7d8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"k", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]k", "]"}], 
         RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]k", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]k", "]"}]}], "}"}], "}"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.84792938111135*^9, 3.847929407019252*^9}},
 CellLabel->"In[28]:=",ExpressionUUID->"3aef267d-5f05-4f87-b9fa-fdb5c3d7ac0f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "kk"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.847362152579423*^9, 3.8473621860827093`*^9}, {
  3.847929369731388*^9, 3.84792937325213*^9}, {3.847929412898686*^9, 
  3.847929413979124*^9}, {3.8479302004495487`*^9, 3.847930210632444*^9}, {
  3.848368654582594*^9, 3.8483686569158497`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"d17213a7-a72c-4410-8706-a13d01631666"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "k", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.847362182867441*^9, 3.8473621865262957`*^9}, {
   3.847401390148943*^9, 3.8474014027046824`*^9}, 3.847413824572401*^9, 
   3.847929414605948*^9, 3.847930211248261*^9, 3.8483682554217253`*^9, 
   3.8483686573371887`*^9},
 CellLabel->"Out[29]=",ExpressionUUID->"dfe33468-06b3-4901-b28a-720ef0f74345"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qq", "=", 
   RowBox[{"q", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq2", "=", 
   RowBox[{"q2", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]2", "]"}], 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]2", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]2", "]"}]}], "}"}], "}"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq3p", "=", 
   RowBox[{"q3p", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]3p", "]"}], 
         RowBox[{"Cos", "[", "\[Phi]3p", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Theta]3p", "]"}], 
         RowBox[{"Sin", "[", "\[Phi]3p", "]"}]}], ",", 
        RowBox[{"Cos", "[", "\[Theta]3p", "]"}]}], "}"}], "}"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.847929421162067*^9, 3.847929507784388*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"09d69124-72de-49b8-a945-f02d9a91a5cd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"qqt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "qq"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]k", "]"}], "\[Rule]", "ck"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]k", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", "c2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]3p", "]"}], "\[Rule]", "c3p"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]3p", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}], "]"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"qq2t", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "qq2"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]k", "]"}], "\[Rule]", "ck"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]k", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", "c2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]3p", "]"}], "\[Rule]", "c3p"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]3p", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}], "]"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"qq3pt", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "qq3p"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]k", "]"}], "\[Rule]", "ck"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]k", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]2", "]"}], "\[Rule]", "c2"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]2", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Cos", "[", "\[Theta]3p", "]"}], "\[Rule]", "c3p"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Theta]3p", "]"}], "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}], "]"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.8479295100602207`*^9, 3.847929551816144*^9}, {
  3.847929602639844*^9, 3.847929657560193*^9}, {3.8479302180995493`*^9, 
  3.8479302235044107`*^9}, {3.848368661276609*^9, 3.8483686773803797`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"f1191cc7-082e-4868-bac9-94433456a953"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
     RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
     RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"ck", " ", "q"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.847929523270432*^9, 3.847929552899271*^9}, 
   3.8479296584291687`*^9, 3.8479302244650106`*^9, 3.8483682567402897`*^9, 
   3.848368678289833*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"cfda8ab4-c316-47b3-ad19-6064c5d53962"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], 
      ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c2", " ", "ck"}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.847929523270432*^9, 3.847929552899271*^9}, 
   3.8479296584291687`*^9, 3.8479302244650106`*^9, 3.8483682567402897`*^9, 
   3.84836867835815*^9},
 CellLabel->"Out[34]=",ExpressionUUID->"4da83ce2-bfb6-4565-8794-5d02329b8e10"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"q3p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c3p"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q3p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c3p"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], 
      ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"q3p", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c3p", " ", "ck"}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.847929523270432*^9, 3.847929552899271*^9}, 
   3.8479296584291687`*^9, 3.8479302244650106`*^9, 3.8483682567402897`*^9, 
   3.848368678360785*^9},
 CellLabel->"Out[35]=",ExpressionUUID->"a9d0f63a-14c7-4c53-b389-ada009c4fe9d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", "qqt", "]"}]], "Input",
 CellChangeTimes->{{3.847929750254849*^9, 3.84792975186761*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"68a8f020-a6c6-491d-b756-886a5cff8dfc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
    RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
    RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
   RowBox[{"ck", " ", "q"}]}], "}"}]], "Output",
 CellChangeTimes->{3.847929752179398*^9, 3.847930234346024*^9, 
  3.848368259142617*^9, 3.848368680728429*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"1c00ca1d-3488-430c-925a-7adfdbae3f50"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"xcoord", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"Flatten", "[", "qqt", "]"}], ",", 
    RowBox[{"Flatten", "[", "qq2t", "]"}], ",", 
    RowBox[{"Flatten", "[", "qq3pt", "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"rcoord", "=", 
  RowBox[{"{", 
   RowBox[{
   "q", ",", "ck", ",", "\[Phi]k", ",", "q2", ",", "c2", ",", "\[Phi]2", ",", 
    "q3p", ",", "c3p", ",", "\[Phi]3p"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.847929560693334*^9, 3.847929574199911*^9}, {
  3.847929671852853*^9, 3.847929691468851*^9}, {3.847929728105753*^9, 
  3.847929774651104*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"2d7970fd-a99a-42ee-b82b-ecf57e7f62f8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
    RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
    RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
   RowBox[{"ck", " ", "q"}], ",", 
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], ")"}]}],
    ",", 
   RowBox[{"q2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c2", " ", "ck"}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{"q3p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c3p"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ")"}]}], 
   ",", 
   RowBox[{"q3p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c3p"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], ")"}]}],
    ",", 
   RowBox[{"q3p", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"c3p", " ", "ck"}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.8479297755426483`*^9, 3.847930236243457*^9, 
  3.8483682603128357`*^9, 3.8483686823831778`*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"3a0ab502-819e-453d-87b2-28db2aa72e46"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "q", ",", "ck", ",", "\[Phi]k", ",", "q2", ",", "c2", ",", "\[Phi]2", ",", 
   "q3p", ",", "c3p", ",", "\[Phi]3p"}], "}"}]], "Output",
 CellChangeTimes->{3.8479297755426483`*^9, 3.847930236243457*^9, 
  3.8483682603128357`*^9, 3.848368682386002*^9},
 CellLabel->"Out[38]=",ExpressionUUID->"b1b94c7b-f98b-4bbf-a1b4-d81acd0f104d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JJ", "=", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", 
       RowBox[{"rcoord", "[", 
        RowBox[{"[", "j", "]"}], "]"}]], 
      RowBox[{"xcoord", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "9"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "9"}], "}"}]}], "]"}], "//", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.8479296962906322`*^9, 3.847929711236739*^9}, {
  3.847929801122347*^9, 3.8479298256273003`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"4350e013-0b4c-431a-8ad1-98f97004ae9a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]]}], " ", 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
     FractionBox[
      RowBox[{"ck", " ", "q", " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]]], ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]], " ", "q", " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]]}], " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
     FractionBox[
      RowBox[{"ck", " ", "q", " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]]], ",", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "ck", ",", "q", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"c2", " ", "ck"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
        RowBox[{"c2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]], " ", 
         RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "ck"}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "+", 
          RowBox[{"c2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "-", 
             RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c2", "2"]}]], " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c2", "2"]}]], " ", "q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]2", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}], ",", "0", ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"c2", " ", "ck"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "-", 
        RowBox[{"c2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]], " ", 
         RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c2"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"q2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c2", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "ck"}], ")"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "-", 
          RowBox[{"c2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]2", "-", 
             RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c2", "2"]}]], " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]]}]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c2", "2"]}]], " ", "q2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]2", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}], ",", "0", ",",
      "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{"c2", "-", 
        FractionBox[
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]], " ", "ck", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]]}], ")"}]}], ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c2", "2"]}]], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]], " ", "q2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"c2", " ", "ck"}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ",", 
     RowBox[{"q2", " ", 
      RowBox[{"(", 
       RowBox[{"ck", "-", 
        FractionBox[
         RowBox[{"c2", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]], " ", "q2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"c3p", " ", "ck"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]3p", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
        RowBox[{"c3p", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]], " ", 
         RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], ",", "0", ",", 
     "0", ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c3p"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"q3p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c3p", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "ck"}], ")"}], " ", 
           RowBox[{"Cos", "[", "\[Phi]3p", "]"}]}], "+", 
          RowBox[{"c3p", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]3p", "-", 
             RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c3p", "2"]}]], " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]]}]]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c3p", "2"]}]], " ", "q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", "\[Phi]3p", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"\[Phi]3p", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{"c3p", " ", "ck"}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]3p", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "-", 
        RowBox[{"c3p", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]], " ", 
         RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], ",", "0", ",", 
     "0", ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "c3p"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
         RowBox[{"ck", " ", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"q3p", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c3p", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "ck"}], ")"}], " ", 
           RowBox[{"Sin", "[", "\[Phi]3p", "]"}]}], "-", 
          RowBox[{"c3p", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"\[Phi]3p", "-", 
             RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c3p", "2"]}]], " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]]}]]}], ",", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c3p", "2"]}]], " ", "q3p", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]3p", "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"\[Phi]3p", "-", 
           RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{"c3p", "-", 
        FractionBox[
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]], " ", "ck", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["ck", "2"]}]]]}], ")"}]}], ",", 
     RowBox[{
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["c3p", "2"]}]], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]], " ", "q3p", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], ",", "0", ",", "0", ",",
      "0", ",", 
     RowBox[{
      RowBox[{"c3p", " ", "ck"}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ",", 
     RowBox[{"q3p", " ", 
      RowBox[{"(", 
       RowBox[{"ck", "-", 
        FractionBox[
         RowBox[{"c3p", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]]}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["ck", "2"]}]], " ", "q3p", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.847929826456572*^9, 3.8479302385850353`*^9, 
  3.848368262522132*^9, 3.848368683554944*^9},
 CellLabel->"Out[39]=",ExpressionUUID->"68663c12-2ba1-470e-9371-fd7261fec87e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"JJ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.847929829534931*^9, 3.847929831714933*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"6e357362-9584-45df-b1f3-5078385b4d47"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]]}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], 
      FractionBox[
       RowBox[{"ck", " ", "q", " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]]], 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", "q", " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "0", "0", "0", "0", "0", "0"},
     {
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]]}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
      FractionBox[
       RowBox[{"ck", " ", "q", " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]]], 
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]]}], " ", "q", " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "0", "0", "0", "0", "0", "0"},
     {"ck", "q", "0", "0", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"c2", " ", "ck"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
         RowBox[{"c2", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "ck"}], ")"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "+", 
           RowBox[{"c2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]2", "-", 
              RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["c2", "2"]}]], " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["ck", "2"]}]], " ", 
            RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", "q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]2", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}], "0", "0", 
      "0"},
     {"0", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"c2", " ", "ck"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "-", 
         RowBox[{"c2", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c2"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"q2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c2", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "ck"}], ")"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]2", "]"}]}], "-", 
           RowBox[{"c2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]2", "-", 
              RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["c2", "2"]}]], " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["ck", "2"]}]], " ", 
            RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c2", "2"]}]]}]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", "q2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]2", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}], "0", "0", 
      "0"},
     {"0", 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"c2", "-", 
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c2", "2"]}]], " ", "ck", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]]}], ")"}]}], 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c2", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", "q2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], 
      RowBox[{
       RowBox[{"c2", " ", "ck"}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}]}], 
      RowBox[{"q2", " ", 
       RowBox[{"(", 
        RowBox[{"ck", "-", 
         FractionBox[
          RowBox[{"c2", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c2", "2"]}]]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c2", "2"]}]]}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", "q2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]2", "-", "\[Phi]k"}], "]"}]}], "0", "0", "0"},
     {"0", 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"c3p", " ", "ck"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]3p", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
         RowBox[{"c3p", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c3p"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"]}], "+", 
          SuperscriptBox[
           RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"q3p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c3p", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "ck"}], ")"}], " ", 
            RowBox[{"Cos", "[", "\[Phi]3p", "]"}]}], "+", 
           RowBox[{"c3p", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Phi]3p", "-", 
              RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["c3p", "2"]}]], " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["ck", "2"]}]], " ", 
            RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]]}]]}], 
      RowBox[{
       RowBox[{"-", 
        FractionBox["1", "2"]}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", "q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", "\[Phi]3p", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Phi]3p", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}]},
     {"0", 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"c3p", " ", "ck"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]], "+", 
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "-", 
         RowBox[{"c3p", " ", 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]], " ", 
          RowBox[{"Cos", "[", "\[Phi]k", "]"}]}]}], ")"}]}], "0", "0", "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "c3p"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        RowBox[{"Sin", "[", "\[Phi]3p", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Cos", "[", "\[Phi]k", "]"}], "2"], "+", 
          RowBox[{"ck", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}]}]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"q3p", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"c3p", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "ck"}], ")"}], " ", 
            RowBox[{"Sin", "[", "\[Phi]3p", "]"}]}], "-", 
           RowBox[{"c3p", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Phi]3p", "-", 
              RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}], "+", 
           RowBox[{"2", " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["c3p", "2"]}]], " ", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["ck", "2"]}]], " ", 
            RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["c3p", "2"]}]]}]]}], 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", "q3p", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", "\[Phi]3p", "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "ck"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"\[Phi]3p", "-", 
            RowBox[{"2", " ", "\[Phi]k"}]}], "]"}]}]}], ")"}]}]},
     {"0", 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{"c3p", "-", 
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["c3p", "2"]}]], " ", "ck", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["ck", "2"]}]]]}], ")"}]}], 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3p", "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", "q3p", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], "0", "0", "0", 
      RowBox[{
       RowBox[{"c3p", " ", "ck"}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["ck", "2"]}]], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}], 
      RowBox[{"q3p", " ", 
       RowBox[{"(", 
        RowBox[{"ck", "-", 
         FractionBox[
          RowBox[{"c3p", " ", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["ck", "2"]}]], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox["c3p", "2"]}]]]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["c3p", "2"]}]]}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["ck", "2"]}]], " ", "q3p", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Phi]3p", "-", "\[Phi]k"}], "]"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.847929832070182*^9, 3.847930239965372*^9, 
  3.84836826828194*^9, 3.8483686884936*^9},
 CellLabel->
  "Out[40]//MatrixForm=",ExpressionUUID->"c08143b8-93cb-40ce-be10-\
c71db1658bc0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Det", "[", "JJ", "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.847929834669341*^9, 3.8479298359139137`*^9}, {
  3.847930253239996*^9, 3.847930254144436*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"50f7a899-c53e-4c30-bb0c-11eeaebde5a1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SuperscriptBox["q", "2"]}], " ", 
  SuperscriptBox["q2", "2"], " ", 
  SuperscriptBox["q3p", "2"]}]], "Output",
 CellChangeTimes->{
  3.8479298366505337`*^9, {3.84793024340728*^9, 3.847930261017918*^9}, 
   3.8483682780541773`*^9, 3.848368697010311*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"33fee35d-ed40-403a-8950-0a99e45c82f1"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8474005551371403`*^9, 3.847400587771185*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"c37d9f10-bb43-41fd-b7e9-950e4aff94d7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pp", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"px", ",", "py", ",", "pz"}], "}"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.847401411211754*^9, 3.847401427928117*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"4f00d8a5-6efe-41c5-a4f9-07bce79b40cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Transpose", "[", "pp", "]"}], ".", "ep", ".", 
  "pp"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transpose", "[", "pp", "]"}], ".", "ec", ".", "pp"}]}], "Input",
 CellChangeTimes->{{3.8474020273782797`*^9, 3.847402041101824*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"b31f6306-04d6-418b-b880-4befd06f081b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    SuperscriptBox["px", "2"], "-", 
    SuperscriptBox["py", "2"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8474020350038757`*^9, 3.8474020413982077`*^9}, 
   3.848368595771555*^9, 3.848368699342621*^9},
 CellLabel->"Out[45]=",ExpressionUUID->"d4aa93ee-4bc0-4dcc-b319-9d9092b0aeb0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"2", " ", "px", " ", "py"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.8474020350038757`*^9, 3.8474020413982077`*^9}, 
   3.848368595771555*^9, 3.84836869934582*^9},
 CellLabel->"Out[46]=",ExpressionUUID->"4529102b-b63c-4023-9e2d-84eb48a69f0c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "pp"}], 
      "]"}], ".", "ep", ".", "R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT",
      ".", "pp"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.847401312811232*^9, 3.847401348110013*^9}, {
  3.847401431057355*^9, 3.8474014426319513`*^9}, {3.8474016557324457`*^9, 
  3.847401656114764*^9}, {3.848368703095327*^9, 3.848368715259815*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"f3f685d1-b0ab-4a2c-8ab0-acf135923e14"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"px", "-", "py"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"px", "+", "py"}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "4"]}], "-", 
  RowBox[{"4", " ", "px", " ", "pz", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "3"], " ", 
   RowBox[{"Cos", "[", "\[Phi]k", "]"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Theta]k", "2"], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"px", "-", "py"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"px", "+", "py"}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"4", " ", "\[Phi]k"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "4"]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["px", "2"], "+", 
     SuperscriptBox["py", "2"], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["pz", "2"]}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"2", " ", "\[Phi]k"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]k", "]"}], "2"]}], "+", 
  RowBox[{"4", " ", "py", " ", "pz", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "3"], " ", 
   RowBox[{"Sin", "[", 
    FractionBox["\[Theta]k", "2"], "]"}], " ", 
   RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
  RowBox[{"2", " ", "py", " ", "pz", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]k", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"3", " ", "\[Phi]k"}], "]"}]}], "+", 
  RowBox[{"2", " ", "px", " ", "py", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "4"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"4", " ", "\[Phi]k"}], "]"}]}], "+", 
  RowBox[{"px", " ", "pz", " ", 
   RowBox[{"Csc", "[", 
    RowBox[{"3", " ", "\[Phi]k"}], "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox["\[Theta]k", "2"], "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]k", "]"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"6", " ", "\[Phi]k"}], "]"}]}]}]], "Output",
 CellChangeTimes->{{3.847401345021299*^9, 3.8474013484581823`*^9}, {
   3.847401434176092*^9, 3.847401442953402*^9}, 3.847401658068262*^9, 
   3.8483687190969543`*^9},
 CellLabel->"Out[47]=",ExpressionUUID->"a85f6b48-29ed-4574-83ca-4927f7af00cf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT", ".", "pp"}], 
      "]"}], ".", "ec", ".", "R\[Phi]k", ".", "R\[Theta]kT", ".", "R\[Phi]kT",
      ".", "pp"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.847401449629384*^9, 3.847401450124505*^9}, {
  3.8474016686134567`*^9, 3.847401669007811*^9}, {3.84836874291855*^9, 
  3.848368745267041*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"6a542a77-06d9-4cac-83f9-5aee68d08313"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", "py", " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]k", "]"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"pz", " ", 
      RowBox[{"Sin", "[", "\[Theta]k", "]"}]}], "+", 
     RowBox[{"py", " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]k", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"px", " ", 
       RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
      RowBox[{"py", " ", 
       RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Phi]k"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["pz", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Theta]k", "]"}], "2"]}], "+", 
     RowBox[{"py", " ", "pz", " ", 
      RowBox[{"Sin", "[", "\[Theta]k", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "-", 
     RowBox[{
      SuperscriptBox["px", "2"], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "\[Phi]k", "]"}], "2"]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Phi]k"}], "]"}]}], "+", 
  RowBox[{"px", " ", "py", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "\[Phi]k"}], "]"}], "2"]}], "-", 
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", "\[Theta]k", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"px", " ", 
      RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
     RowBox[{"py", " ", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "\[Phi]k"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "py"}], " ", 
         RowBox[{"Cos", "[", "\[Phi]k", "]"}]}], "+", 
        RowBox[{"px", " ", 
         RowBox[{"Sin", "[", "\[Phi]k", "]"}]}]}], ")"}]}], "+", 
     RowBox[{"pz", " ", 
      RowBox[{"Sin", "[", "\[Theta]k", "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[Phi]k"}], "]"}]}]}], ")"}]}], "+", 
  RowBox[{"px", " ", "pz", " ", 
   RowBox[{"Sin", "[", "\[Theta]k", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]k", "]"}]}], "+", 
     RowBox[{"Sin", "[", 
      RowBox[{"3", " ", "\[Phi]k"}], "]"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.8474014504630527`*^9, 3.8474016697614927`*^9, 
  3.8483687490187597`*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"200cbbef-9800-45cb-b502-41db9da6b401"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qq2", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["ks", "2"], "-", 
          FractionBox[
           SuperscriptBox["q", "2"], "4"]}], "]"}], 
        RowBox[{"Cos", "[", "p2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{
          SuperscriptBox["ks", "2"], "-", 
          FractionBox[
           SuperscriptBox["q", "2"], "4"]}], "]"}], 
        RowBox[{"Sin", "[", "p2", "]"}]}], ",", 
       FractionBox["q", "2"]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{"k", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "t", "]"}], 
         RowBox[{"Cos", "[", "p", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "t", "]"}], 
         RowBox[{"Sin", "[", "p", "]"}]}], ",", 
        RowBox[{"Cos", "[", "t", "]"}]}], "}"}], "}"}], "]"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.8474138481456842`*^9, 3.8474138492360563`*^9}, {
  3.8474138862940283`*^9, 3.8474139766882257`*^9}, {3.8474140896756697`*^9, 
  3.8474141594121027`*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"41a4a481-13d7-42cb-84a0-564f820fe016"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "qq2", "]"}], ".", "qq2"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.847413989695362*^9, 3.847414011677383*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"5c67bc5e-4f37-4b5d-a71e-6b5dbcd43feb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   SuperscriptBox["ks", "2"], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.847413993212088*^9, 3.847414011992202*^9}},
 CellLabel->"Out[96]=",ExpressionUUID->"cb81bf9f-e52d-4817-b0c3-00a558c8fe3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Rt", ".", "Rp", ".", "qq2"}], "]"}], ".", "ep", ".", "Rt", ".",
      "Rp", ".", "qq2"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8474140231289577`*^9, 3.847414027493569*^9}},
 CellLabel->
  "In[114]:=",ExpressionUUID->"343918e7-2cb6-4936-a908-a9040269a070"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "16"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["ks", "2"]}], "-", 
       SuperscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"p", "-", "p2"}], ")"}]}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"3", "+", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "t"}], "]"}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", "t", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "q", " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["ks", "2"]}], "-", 
          SuperscriptBox["q", "2"]}]], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"p", "-", "p2"}], "]"}], " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", 
           SuperscriptBox["ks", "2"]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "t", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.847415441496257*^9},
 CellLabel->
  "Out[114]=",ExpressionUUID->"f727acb7-159e-4dfc-81ab-4936944d4ff6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Rt", ".", "Rp", ".", "qq2"}], "]"}], ".", "ec", ".", "Rt", ".",
      "Rp", ".", "qq2"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.847414046416276*^9, 3.8474140511185226`*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"3e4b1e93-ce6d-4e4f-a603-3b954b1c9452"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"p", "-", "p2"}], "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", 
        SuperscriptBox["ks", "2"]}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"p", "-", "p2"}], "]"}], " ", 
     RowBox[{"Cos", "[", "t", "]"}]}], "+", 
    RowBox[{"q", " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["ks", "2"]}], "-", 
       SuperscriptBox["q", "2"]}]], " ", 
     RowBox[{"Sin", "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8474140528236017`*^9},
 CellLabel->"Out[98]=",ExpressionUUID->"4cff08c0-df35-42dc-892a-935b40e709e2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"kk", "-", "qq2"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"kk", "-", "qq2"}], ")"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.847414162810657*^9, 3.847414189980123*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"47d00020-73b3-4bc0-8299-6f208cf81fba"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["k", "2"], "+", 
  SuperscriptBox["ks", "2"], "-", 
  RowBox[{"k", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"q", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], "+", 
     RowBox[{
      SqrtBox[
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["ks", "2"]}], "-", 
        SuperscriptBox["q", "2"]}]], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"p", "-", "p2"}], "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.8474141769310427`*^9, 3.847414191193983*^9}},
 CellLabel->
  "Out[103]=",ExpressionUUID->"40b79d1b-34f2-4f8f-8655-32c02fea4c5b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Rt", ".", "Rp", ".", "qq1"}], "]"}], ".", "ep", ".", "Rt", ".",
      "Rp", ".", "qq1"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.84741431368437*^9, 3.847414315664361*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"10826bc6-fb18-4451-9998-552e1f69faf7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"q", "+", 
      RowBox[{"ks", " ", 
       RowBox[{"Cos", "[", "t3", "]"}]}]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "t", "]"}], "2"]}], "+", 
  RowBox[{
   FractionBox["1", "4"], " ", "ks", " ", 
   RowBox[{"Sin", "[", "t3", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"p", "-", "p3"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"q", "+", 
        RowBox[{"ks", " ", 
         RowBox[{"Cos", "[", "t3", "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "t"}], "]"}]}], "+", 
     RowBox[{"ks", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"p", "-", "p3"}], ")"}]}], "]"}]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", 
           RowBox[{"p", "-", "p3"}], "]"}], "2"], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "t"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"Sin", "[", "t3", "]"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.847414321390839*^9, 3.847414787344687*^9},
 CellLabel->
  "Out[110]=",ExpressionUUID->"7afd490f-94d2-4db1-811e-a0ae638a2399"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Rt", ".", "Rp", ".", "qq1"}], "]"}], ".", "ec", ".", "Rt", ".",
      "Rp", ".", "qq1"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8474143516871643`*^9, 3.84741435366733*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"5e8432fc-ac11-4e72-a0e4-0118b2230cd0"],

Cell[BoxData[
 RowBox[{"2", " ", "ks", " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"p", "-", "p3"}], "]"}], " ", 
  RowBox[{"Sin", "[", "t3", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"q", "+", 
       RowBox[{"ks", " ", 
        RowBox[{"Cos", "[", "t3", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "t", "]"}]}], "-", 
    RowBox[{"ks", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"p", "-", "p3"}], "]"}], " ", 
     RowBox[{"Cos", "[", "t", "]"}], " ", 
     RowBox[{"Sin", "[", "t3", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.8474143546170187`*^9, 3.847414789134776*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"72bc527d-64e7-40d9-a38e-0e999040083e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"kk", "-", "qq1"}], "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"kk", "-", "qq1"}], ")"}]}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.8474143660199957`*^9, 3.847414368190853*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"bba223c6-81e2-4b2e-8868-39b4f9730b55"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["k", "2"], "+", 
  SuperscriptBox["ks", "2"], "+", 
  SuperscriptBox["q", "2"], "+", 
  RowBox[{"2", " ", "ks", " ", "q", " ", 
   RowBox[{"Cos", "[", "t3", "]"}]}], "-", 
  RowBox[{"2", " ", "k", " ", 
   RowBox[{"Cos", "[", "t", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"q", "+", 
     RowBox[{"ks", " ", 
      RowBox[{"Cos", "[", "t3", "]"}]}]}], ")"}]}], "-", 
  RowBox[{"2", " ", "k", " ", "ks", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{"p", "-", "p3"}], "]"}], " ", 
   RowBox[{"Sin", "[", "t", "]"}], " ", 
   RowBox[{"Sin", "[", "t3", "]"}]}]}]], "Output",
 CellChangeTimes->{3.847416011985754*^9},
 CellLabel->
  "Out[117]=",ExpressionUUID->"56e46891-fbb2-4dc4-b146-ee6118bef66e"]
}, Open  ]],

Cell[CellGroupData[{

Cell["num", "Subsection",
 CellChangeTimes->{{3.847430233246232*^9, 
  3.847430233482658*^9}},ExpressionUUID->"7b00873b-98fb-426e-b724-\
df3e6fb0dbc3"],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.8474302355471363`*^9, 3.847430236205254*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"766bd9ef-ed60-41fc-bf5d-40a284298bb9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"k", ">", "0"}], ",", 
    RowBox[{"q", ">", "0"}], ",", 
    RowBox[{
     RowBox[{"-", "1"}], "<", "c3", "<", "1"}], ",", 
    RowBox[{"0", "<", "p3", "<", 
     RowBox[{"2", "\[Pi]"}]}], ",", 
    RowBox[{"0", "<", "p2", "<", 
     RowBox[{"2", "\[Pi]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.847432065946999*^9, 3.8474321045996313`*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"d699a176-a0bc-4ab6-a106-09bb6c305204"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k", ">", "0"}], ",", 
   RowBox[{"q", ">", "0"}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "<", "c3", "<", "1"}], ",", 
   RowBox[{"0", "<", "p3", "<", 
    RowBox[{"2", " ", "\[Pi]"}]}], ",", 
   RowBox[{"0", "<", "p2", "<", 
    RowBox[{"2", " ", "\[Pi]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.8474321050191927`*^9, 3.847498639963657*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"66e471ca-86fc-414a-bbf7-2db6466d8fff"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Rt", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Cos", "[", "tk", "]"}], ",", "0", ",", 
         RowBox[{"-", 
          RowBox[{"Sin", "[", "tk", "]"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Sin", "[", "tk", "]"}], ",", "0", ",", 
         RowBox[{"Cos", "[", "tk", "]"}]}], "}"}]}], "}"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "tk", "]"}], "->", 
        FractionBox[
         RowBox[{
          SuperscriptBox["q", "2"], "+", 
          SuperscriptBox["k", "2"], "-", "1"}], 
         RowBox[{"2", "q", " ", "k"}]]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "tk", "]"}], "->", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              SuperscriptBox["q", "2"], "+", 
              SuperscriptBox["k", "2"], "-", "1"}], 
             RowBox[{"2", "q", " ", "k"}]], ")"}], "2"]}], "]"}]}]}], "}"}]}],
     "//", "Simplify"}]}], ";", 
  RowBox[{"Rt", "//", "MatrixForm"}]}]], "Input",
 CellChangeTimes->{{3.8473620663312473`*^9, 3.847362138764655*^9}, {
   3.84740136590833*^9, 3.847401401278686*^9}, 3.847430316431335*^9, {
   3.8474303756400537`*^9, 3.847430434051989*^9}, 3.847430735384145*^9, 
   3.847499160513289*^9, 3.847499282354994*^9},
 CellLabel->"In[46]:=",ExpressionUUID->"2a6eb6be-c57e-405c-94a9-31ca53c574bb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["k", "2"], "+", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"2", " ", "k", " ", "q"}]], "0", 
      RowBox[{"-", 
       SqrtBox[
        RowBox[{"1", "-", 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["k", "2"], "+", 
             SuperscriptBox["q", "2"]}], ")"}], "2"], 
          RowBox[{"4", " ", 
           SuperscriptBox["k", "2"], " ", 
           SuperscriptBox["q", "2"]}]]}]]}]},
     {"0", "1", "0"},
     {
      SqrtBox[
       RowBox[{"1", "-", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["k", "2"], "+", 
            SuperscriptBox["q", "2"]}], ")"}], "2"], 
         RowBox[{"4", " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["q", "2"]}]]}]], "0", 
      FractionBox[
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["k", "2"], "+", 
        SuperscriptBox["q", "2"]}], 
       RowBox[{"2", " ", "k", " ", "q"}]]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8474302834592237`*^9, 3.8474303168234777`*^9, 
  3.847430382380185*^9, 3.847430436166184*^9, 3.8474307362819853`*^9, 
  3.847432105834991*^9, 3.847499096873522*^9, 3.8474991626465673`*^9, 
  3.847499283322982*^9},
 CellLabel->
  "Out[46]//MatrixForm=",ExpressionUUID->"a1b75ad3-6438-4d99-a70e-\
46c734641d66"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ep", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ec", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8474005551371403`*^9, 3.847400587771185*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"85ee119c-054e-4c53-8437-5e064f9db1b1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qq1", "=", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"Sin", "[", "t3", "]"}], 
         RowBox[{"Cos", "[", "p3", "]"}]}], ",", 
        RowBox[{
         RowBox[{"Sin", "[", "t3", "]"}], 
         RowBox[{"Sin", "[", "p3", "]"}]}], ",", 
        RowBox[{"q", "+", 
         RowBox[{"Cos", "[", "t3", "]"}]}]}], "}"}], "}"}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "t3", "]"}], "->", "c3"}], ",", 
      RowBox[{
       RowBox[{"Sin", "[", "t3", "]"}], "->", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         SuperscriptBox["c3", "2"]}], "]"}]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq2", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          FractionBox[
           SuperscriptBox["q", "2"], "4"]}], "]"}], 
        RowBox[{"Cos", "[", "p2", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          FractionBox[
           SuperscriptBox["q", "2"], "4"]}], "]"}], 
        RowBox[{"Sin", "[", "p2", "]"}]}], ",", 
       FractionBox["q", "2"]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kk", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"k", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Sin", "[", "tk", "]"}], ",", "0", ",", 
          RowBox[{"Cos", "[", "tk", "]"}]}], "}"}], "}"}], "]"}]}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "tk", "]"}], "->", 
        FractionBox[
         RowBox[{
          SuperscriptBox["q", "2"], "+", 
          SuperscriptBox["k", "2"], "-", "1"}], 
         RowBox[{"2", "q", " ", "k"}]]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "tk", "]"}], "->", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox[
             RowBox[{
              SuperscriptBox["q", "2"], "+", 
              SuperscriptBox["k", "2"], "-", "1"}], 
             RowBox[{"2", "q", " ", "k"}]], ")"}], "2"]}], "]"}]}]}], "}"}]}],
     "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8474008729743433`*^9, 3.847400879157292*^9}, {
  3.8474147703949833`*^9, 3.8474147763670597`*^9}, {3.8474303266788273`*^9, 
  3.847430335129142*^9}, {3.8474304540010443`*^9, 3.8474304827538958`*^9}, {
  3.847430677719839*^9, 3.8474306977540483`*^9}, {3.847430766485217*^9, 
  3.847430778113534*^9}, {3.847430842782366*^9, 3.8474308428814697`*^9}, {
  3.8474308833391657`*^9, 3.8474308970276537`*^9}, {3.847499142007958*^9, 
  3.8474991709660673`*^9}, {3.847499288581736*^9, 3.847499292613894*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"ff514563-d66e-4a05-a946-b8b4e8878e5e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"qq", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "q"}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q3p", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", "t3", "]"}], 
          RowBox[{"Cos", "[", "p3", "]"}]}], ",", 
         RowBox[{
          RowBox[{"Sin", "[", "t3", "]"}], 
          RowBox[{"Sin", "[", "p3", "]"}]}], ",", 
         RowBox[{"Cos", "[", "t3", "]"}]}], "}"}], "}"}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "t3", "]"}], "->", "c3"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "t3", "]"}], "->", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          SuperscriptBox["c3", "2"]}], "]"}]}]}], "}"}]}], "//", 
    "Simplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"qq3", "=", 
   RowBox[{
    RowBox[{"qq2", "+", "q3p"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1p", "=", 
   RowBox[{
    RowBox[{"qq", "-", "qq2"}], "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.847430986433777*^9, 3.847431096096949*^9}, 
   3.8474991776686697`*^9, 3.84749929739394*^9},
 CellLabel->"In[52]:=",ExpressionUUID->"0c30d520-33b9-4cf3-b1f3-dedefaf587cf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"qq", "-", "kk"}], "]"}], ".", 
    RowBox[{"(", 
     RowBox[{"qq", "-", "kk"}], ")"}]}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "tk", "]"}], "->", 
      FractionBox[
       RowBox[{
        SuperscriptBox["q", "2"], "+", 
        SuperscriptBox["k", "2"], "-", "1"}], 
       RowBox[{"2", "q", " ", "k"}]]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "tk", "]"}], "->", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox[
           RowBox[{
            SuperscriptBox["q", "2"], "+", 
            SuperscriptBox["k", "2"], "-", "1"}], 
           RowBox[{"2", "q", " ", "k"}]], ")"}], "2"]}], "]"}]}]}], "}"}]}], "//",
   "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "q1p", "]"}], ".", "q1p"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "qq2", "]"}], ".", "qq2"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Transpose", "[", "q3p", "]"}], ".", "q3p"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.847431101016699*^9, 3.847431140199024*^9}, 
   3.847499190793941*^9},
 CellLabel->"In[56]:=",ExpressionUUID->"7f662e7a-0ac4-40d5-b9b8-401b808872b8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.847431111688726*^9, 3.847431140546464*^9}, 
   3.847432112859387*^9, 3.847499097747849*^9, {3.847499179845413*^9, 
   3.847499191545064*^9}, 3.84749929914328*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"171dd28b-3d2b-4cf1-b7a8-2044346a21ba"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.847431111688726*^9, 3.847431140546464*^9}, 
   3.847432112859387*^9, 3.847499097747849*^9, {3.847499179845413*^9, 
   3.847499191545064*^9}, 3.847499299147422*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"db4907dd-4db0-4551-b8e8-099ebc858ea3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.847431111688726*^9, 3.847431140546464*^9}, 
   3.847432112859387*^9, 3.847499097747849*^9, {3.847499179845413*^9, 
   3.847499191545064*^9}, 3.847499299151176*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"d91edd79-8e0b-4612-954b-ee0d695cbb2d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1", "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.847431111688726*^9, 3.847431140546464*^9}, 
   3.847432112859387*^9, 3.847499097747849*^9, {3.847499179845413*^9, 
   3.847499191545064*^9}, 3.847499299154703*^9},
 CellLabel->"Out[59]=",ExpressionUUID->"fb74253d-fad8-4471-9419-a519159a2347"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Transpose", "[", "kk", "]"}], ".", "kk"}], ")"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.8474304748698177`*^9, 3.847430531389433*^9}, {
  3.847430581564135*^9, 3.84743058979959*^9}, {3.84743066397115*^9, 
  3.8474306835351458`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"803fb4ac-6513-49bc-b391-c6c9320f250e"],

Cell[BoxData[
 SuperscriptBox["k", "2"]], "Output",
 CellChangeTimes->{{3.84743047614841*^9, 3.847430533914701*^9}, {
   3.8474305863122396`*^9, 3.847430590647517*^9}, {3.847430658907435*^9, 
   3.847430739580126*^9}, 3.847430781171915*^9, 3.847430844912942*^9, 
   3.847430901346868*^9, 3.847431146968307*^9, 3.8474321138172293`*^9, 
   3.847499098720091*^9, 3.847499194073968*^9, 3.84749930012632*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"3887f067-9395-4a20-be38-305e03fb4f78"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kq1", "[", 
   RowBox[{"k_", ",", "q_", ",", "c3_", ",", "p3_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"kk", "-", "qq1"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"kk", "-", "qq1"}], ")"}]}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"kq2", "[", 
   RowBox[{"k_", ",", "q_", ",", "p2_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", 
        RowBox[{"kk", "-", "qq2"}], "]"}], ".", 
       RowBox[{"(", 
        RowBox[{"kk", "-", "qq2"}], ")"}]}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "[", 
   RowBox[{"q_", ",", "c3_"}], "]"}], "=", 
  RowBox[{
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Transpose", "[", "qq1", "]"}], ".", "qq1"}], ")"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.847431755162547*^9, 3.8474318530704412`*^9}, {
  3.847431887462399*^9, 3.847431914518312*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"13e2129c-337a-44fd-9812-7552da9e4144"],

Cell[BoxData[
 SqrtBox[
  FractionBox[
   RowBox[{
    RowBox[{"2", " ", "q"}], "+", 
    RowBox[{"c3", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["q", "2"]}], ")"}]}], "-", 
    RowBox[{
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["c3", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["k", "4"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["q", "2"]}], ")"}], "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["q", "2"]}], ")"}]}]}], ")"}]}]], " ", 
     RowBox[{"Cos", "[", "p3", "]"}]}]}], "q"]]], "Output",
 CellChangeTimes->{{3.847431776436648*^9, 3.8474318619635*^9}, {
   3.8474319079563713`*^9, 3.847431918604528*^9}, 3.8474321148993607`*^9, 
   3.8474991006040792`*^9, 3.847499196251403*^9, 3.84749930143499*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"80f46c47-c176-45dd-a7cc-ef65f135182b"],

Cell[BoxData[
 FractionBox[
  SqrtBox[
   RowBox[{"3", "+", 
    SuperscriptBox["k", "2"], "-", 
    SuperscriptBox["q", "2"], "-", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"4", "-", 
        SuperscriptBox["q", "2"]}]], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["k", "4"]}], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["q", "2"]}], ")"}], "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["q", "2"]}], ")"}]}]}]], " ", 
      RowBox[{"Cos", "[", "p2", "]"}]}], "q"]}]], 
  SqrtBox["2"]]], "Output",
 CellChangeTimes->{{3.847431776436648*^9, 3.8474318619635*^9}, {
   3.8474319079563713`*^9, 3.847431918604528*^9}, 3.8474321148993607`*^9, 
   3.8474991006040792`*^9, 3.847499196251403*^9, 3.847499302233809*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"fff012e4-52d7-4b37-bcac-56d7867bed98"],

Cell[BoxData[
 SqrtBox[
  RowBox[{"1", "+", 
   RowBox[{"2", " ", "c3", " ", "q"}], "+", 
   SuperscriptBox["q", "2"]}]]], "Output",
 CellChangeTimes->{{3.847431776436648*^9, 3.8474318619635*^9}, {
   3.8474319079563713`*^9, 3.847431918604528*^9}, 3.8474321148993607`*^9, 
   3.8474991006040792`*^9, 3.847499196251403*^9, 3.847499302242057*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"88851929-ade4-4886-9eb1-d0cfa77054c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Q1p", "[", 
   RowBox[{"k_", ",", "q_", ",", "c3_", ",", "p3_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rt", ".", "qq1"}], "]"}], ".", "ep", ".", "Rt", ".", "qq1"}], 
     ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q1c", "[", 
   RowBox[{"k_", ",", "q_", ",", "c3_", ",", "p3_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rt", ".", "qq1"}], "]"}], ".", "ec", ".", "Rt", ".", "qq1"}], 
     ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q2p", "[", 
   RowBox[{"k_", ",", "q_", ",", "p2_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rt", ".", "qq2"}], "]"}], ".", "ep", ".", "Rt", ".", "qq2"}], 
     ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Q2c", "[", 
   RowBox[{"k_", ",", "q_", ",", "p2_"}], "]"}], "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"Rt", ".", "qq2"}], "]"}], ".", "ec", ".", "Rt", ".", "qq2"}], 
     ")"}], "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.847430336604786*^9, 3.8474303670112247`*^9}, {
  3.847430745770493*^9, 3.847430746164898*^9}, {3.8474307861357393`*^9, 
  3.847430848988902*^9}, {3.847431157456922*^9, 3.84743120081284*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"63513eee-8789-4232-93e3-e5d8b4a8c771"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["c3", "2"]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["k", "2"], "+", 
      SuperscriptBox["q", "2"]}], ")"}], " ", 
    RowBox[{"Cos", "[", "p3", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"c3", "+", "q"}], ")"}], " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"-", 
            SuperscriptBox["k", "4"]}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["q", "2"]}], ")"}], "2"], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["q", "2"]}], ")"}]}]}]]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["k", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "p3", "]"}]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox["k", "2"], " ", 
    SuperscriptBox["q", "2"]}]], "-", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"c3", "+", "q"}], ")"}], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     FractionBox[
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["k", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}], "2"], 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["q", "2"]}]]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"c3", "+", "q"}], ")"}], " ", 
        SqrtBox[
         RowBox[{"1", "-", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["k", "2"], "+", 
              SuperscriptBox["q", "2"]}], ")"}], "2"], 
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"], " ", 
            SuperscriptBox["q", "2"]}]]}]]}], ")"}]}], "+", 
     FractionBox[
      RowBox[{
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["c3", "2"]}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["k", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "p3", "]"}]}], 
      RowBox[{"2", " ", "k", " ", "q"}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c3", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "p3", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.847430359964757*^9, 3.8474303680410013`*^9}, {
   3.847430742559688*^9, 3.847430787731503*^9}, {3.847430850204591*^9, 
   3.847430860096891*^9}, 3.847430902908009*^9, {3.847431151167026*^9, 
   3.847431201109297*^9}, 3.8474321275922117`*^9, 3.847499198881892*^9, 
   3.847499304692876*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"d6bf00c6-b414-40db-838f-5ff4d68ce5ec"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c3", "+", "q"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c3", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["k", "4"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              SuperscriptBox["q", "2"]}], ")"}], "2"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["q", "2"]}], ")"}]}]}], ")"}]}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["c3", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["k", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "p3", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "p3", "]"}]}], 
   RowBox[{"k", " ", "q"}]]}]], "Output",
 CellChangeTimes->{{3.847430359964757*^9, 3.8474303680410013`*^9}, {
   3.847430742559688*^9, 3.847430787731503*^9}, {3.847430850204591*^9, 
   3.847430860096891*^9}, 3.847430902908009*^9, {3.847431151167026*^9, 
   3.847431201109297*^9}, 3.8474321275922117`*^9, 3.847499198881892*^9, 
   3.847499305115274*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"38414932-5fe9-467f-ba7f-fc5f4908a9a2"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["q", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "4"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], "2"], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "2"]}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", "q", " ", 
     SqrtBox[
      RowBox[{"4", "-", 
       SuperscriptBox["q", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["k", "2"], "+", 
       SuperscriptBox["q", "2"]}], ")"}], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["k", "4"]}], "-", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], "2"], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          SuperscriptBox["q", "2"]}], ")"}]}]}]], " ", 
     RowBox[{"Cos", "[", "p2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "+", 
       SuperscriptBox["q", "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["k", "4"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["q", "2"]}], ")"}], "2"], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["q", "2"]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "p2"}], "]"}]}]}], 
   RowBox[{"32", " ", 
    SuperscriptBox["k", "2"], " ", 
    SuperscriptBox["q", "2"]}]]}]], "Output",
 CellChangeTimes->{{3.847430359964757*^9, 3.8474303680410013`*^9}, {
   3.847430742559688*^9, 3.847430787731503*^9}, {3.847430850204591*^9, 
   3.847430860096891*^9}, 3.847430902908009*^9, {3.847431151167026*^9, 
   3.847431201109297*^9}, 3.8474321275922117`*^9, 3.847499198881892*^9, 
   3.8474993058686733`*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"374721a2-12e2-47c7-a0e2-7d2bf4c4499f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"q", " ", 
       SqrtBox[
        RowBox[{"4", "-", 
         SuperscriptBox["q", "2"]}]], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k", "4"]}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SuperscriptBox["q", "2"]}], ")"}], "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["k", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["q", "2"]}], ")"}]}]}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "+", 
         SuperscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["k", "2"], "+", 
         SuperscriptBox["q", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "p2", "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", "p2", "]"}]}], 
   RowBox[{"4", " ", "k", " ", "q"}]]}]], "Output",
 CellChangeTimes->{{3.847430359964757*^9, 3.8474303680410013`*^9}, {
   3.847430742559688*^9, 3.847430787731503*^9}, {3.847430850204591*^9, 
   3.847430860096891*^9}, 3.847430902908009*^9, {3.847431151167026*^9, 
   3.847431201109297*^9}, 3.8474321275922117`*^9, 3.847499198881892*^9, 
   3.847499306263451*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"0f6bd38f-1608-4bed-a545-55565609305e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Q1p", "[", 
  RowBox[{"1", ",", "1", ",", "0.5", ",", "\[Pi]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Q1c", "[", 
  RowBox[{"1", ",", "1", ",", "0.5", ",", 
   RowBox[{"\[Pi]", "/", "2"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Q2p", "[", 
  RowBox[{"1", ",", "1", ",", "\[Pi]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Q2c", "[", 
  RowBox[{"1", ",", "1", ",", 
   RowBox[{"\[Pi]", "/", "2"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.847430865126956*^9, 3.847430875203169*^9}, {
  3.847431181171433*^9, 3.8474312145940437`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"af1eb922-7537-49d4-a7b1-b1377bed7ca7"],

Cell[BoxData["3.`"], "Output",
 CellChangeTimes->{{3.847430875604937*^9, 3.847430904840763*^9}, 
   3.84743115435717*^9, {3.847431188789546*^9, 3.8474312148817453`*^9}, 
   3.847432138350909*^9, 3.847499307116918*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"48fa2394-fc23-400a-804c-fd953e92a10d"],

Cell[BoxData[
 RowBox[{"-", "2.25`"}]], "Output",
 CellChangeTimes->{{3.847430875604937*^9, 3.847430904840763*^9}, 
   3.84743115435717*^9, {3.847431188789546*^9, 3.8474312148817453`*^9}, 
   3.847432138350909*^9, 3.847499307120956*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"c68e29b4-1b82-484d-8473-b8aeb530b0d0"],

Cell[BoxData[
 FractionBox["3", "4"]], "Output",
 CellChangeTimes->{{3.847430875604937*^9, 3.847430904840763*^9}, 
   3.84743115435717*^9, {3.847431188789546*^9, 3.8474312148817453`*^9}, 
   3.847432138350909*^9, 3.8474993071246233`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"bd8163dc-f98a-4761-8054-4820c017e934"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["3", "4"]}]], "Output",
 CellChangeTimes->{{3.847430875604937*^9, 3.847430904840763*^9}, 
   3.84743115435717*^9, {3.847431188789546*^9, 3.8474312148817453`*^9}, 
   3.847432138350909*^9, 3.847499307128092*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"01fabb91-75c9-4b63-b88d-ed25c7b7f9e9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"I2bar", "[", 
    RowBox[{"p1_", ",", "q1_", ",", "p2_", ",", "q2_", ",", "k_"}], "]"}], 
   "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"3", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p1", "2"], "+", 
         SuperscriptBox["q1", "2"], "-", 
         RowBox[{"3", 
          SuperscriptBox["k", "2"]}]}], ")"}]}], 
      RowBox[{"4", 
       SuperscriptBox["p1", "3"], 
       SuperscriptBox["q1", "3"]}]], 
     FractionBox[
      RowBox[{"3", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["p2", "2"], "+", 
         SuperscriptBox["q2", "2"], "-", 
         RowBox[{"3", 
          SuperscriptBox["k", "2"]}]}], ")"}]}], 
      RowBox[{"4", 
       SuperscriptBox["p2", "3"], 
       SuperscriptBox["q2", "3"]}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "p1", " ", "q1"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p1", "2"], "+", 
             SuperscriptBox["q1", "2"], "-", 
             RowBox[{"3", 
              SuperscriptBox["k", "2"]}]}], ")"}], 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"3", 
                SuperscriptBox["k", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p1", "+", "q1"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"3", 
                SuperscriptBox["k", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p1", "-", "q1"}], ")"}], "2"]}]], "]"}], "]"}]}]}], 
         ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], "p2", " ", "q2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["p2", "2"], "+", 
             SuperscriptBox["q2", "2"], "-", 
             RowBox[{"3", 
              SuperscriptBox["k", "2"]}]}], ")"}], 
           RowBox[{"Log", "[", 
            RowBox[{"Abs", "[", 
             FractionBox[
              RowBox[{
               RowBox[{"3", 
                SuperscriptBox["k", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p2", "+", "q2"}], ")"}], "2"]}], 
              RowBox[{
               RowBox[{"3", 
                SuperscriptBox["k", "2"]}], "-", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"p2", "-", "q2"}], ")"}], "2"]}]], "]"}], "]"}]}]}], 
         ")"}]}], "\[IndentingNewLine]", "+", 
       RowBox[{
        SuperscriptBox["\[Pi]", "2"], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p1", "2"], "+", 
          SuperscriptBox["q1", "2"], "-", 
          RowBox[{"3", 
           SuperscriptBox["k", "2"]}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["p2", "2"], "+", 
          SuperscriptBox["q2", "2"], "-", 
          RowBox[{"3", 
           SuperscriptBox["k", "2"]}]}], ")"}], 
        RowBox[{"UnitStep", "[", 
         RowBox[{
          RowBox[{"p1", "+", "q1", "-", 
           RowBox[{
            RowBox[{"Sqrt", "[", "3", "]"}], "k"}]}], ",", 
          RowBox[{"p2", "+", "q2", "-", 
           RowBox[{
            RowBox[{"Sqrt", "[", "3", "]"}], "k"}]}]}], "]"}]}]}], ")"}]}], "//",
     "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.847431365722127*^9, 3.847431607404055*^9}, {
   3.8474316561281967`*^9, 3.847431658333496*^9}, 3.84743423045569*^9, 
   3.847434265651379*^9},
 CellLabel->"In[72]:=",ExpressionUUID->"27ce2a7e-27c1-43b9-8eb8-739674c6fa7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PpIntegrand", "[", 
    RowBox[{"k_", ",", "q_", ",", "c3_", ",", "p3_", ",", "p2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Q1p", "[", 
     RowBox[{"k", ",", "q", ",", "c3", ",", "p3"}], "]"}], 
    RowBox[{"Q2p", "[", 
     RowBox[{"k", ",", "q", ",", "p2"}], "]"}], 
    RowBox[{"I2bar", "[", 
     RowBox[{
      RowBox[{"kq1", "[", 
       RowBox[{"k", ",", "q", ",", "c3", ",", "p3"}], "]"}], ",", 
      RowBox[{"q1", "[", 
       RowBox[{"q", ",", "c3"}], "]"}], ",", 
      RowBox[{"kq2", "[", 
       RowBox[{"k", ",", "q", ",", "p2"}], "]"}], ",", "1", ",", "k"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PcIntegrand", "[", 
    RowBox[{"k_", ",", "q_", ",", "c3_", ",", "p3_", ",", "p2_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"Q1c", "[", 
     RowBox[{"k", ",", "q", ",", "c3", ",", "p3"}], "]"}], 
    RowBox[{"Q2c", "[", 
     RowBox[{"k", ",", "q", ",", "p2"}], "]"}], 
    RowBox[{"I2bar", "[", 
     RowBox[{
      RowBox[{"kq1", "[", 
       RowBox[{"k", ",", "q", ",", "c3", ",", "p3"}], "]"}], ",", 
      RowBox[{"q1", "[", 
       RowBox[{"q", ",", "c3"}], "]"}], ",", 
      RowBox[{"kq2", "[", 
       RowBox[{"k", ",", "q", ",", "p2"}], "]"}], ",", "1", ",", "k"}], 
     "]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.847432178244451*^9, 3.847432210296276*^9}, 
   3.847432448673728*^9, {3.847434248357576*^9, 3.847434275696094*^9}, {
   3.84743445236926*^9, 3.847434462153653*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"84542494-bdaf-4842-a6be-5b2eb501658f"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PcIntegrand", "[", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "q", ",", "0", ",", 
     RowBox[{"\[Pi]", "/", "3"}], ",", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"q", ",", 
     RowBox[{"1", "/", "2"}], ",", 
     RowBox[{"3", "/", "2"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.847432211558865*^9, 3.84743222664056*^9}, {
  3.847432450977446*^9, 3.847432454587249*^9}, {3.847433749247971*^9, 
  3.8474338010418997`*^9}, {3.847433836470118*^9, 3.847433866461369*^9}},
 CellLabel->
  "In[197]:=",ExpressionUUID->"bd20813d-cdeb-492b-beda-69e606b3b23c"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[3], Opacity[
      1.], LineBox[CompressedData["
1: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
       "]]},
     Annotation[#, "Charting`Private`Tag$53052#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0.5, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  LabelStyle->Directive[Large, 
    GrayLevel[0], FontFamily -> "Palatino"],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->NCache[{{
      Rational[1, 2], 
      Rational[3, 2]}, {-11.188341128976669`, 18.281247548250462`}}, {{0.5, 
    1.5}, {-11.188341128976669`, 18.281247548250462`}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.847432223932839*^9, 3.8474322269920464`*^9}, {
  3.847432451368565*^9, 3.847432454835141*^9}, {3.847433768310731*^9, 
  3.847433802041697*^9}, {3.847433848408368*^9, 3.847433867301691*^9}},
 CellLabel->
  "Out[197]=",ExpressionUUID->"382543a2-9367-4b9a-bd4e-9e5f04c273b4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PcIntegrand", "[", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}], ",", "p3", ",", 
     RowBox[{"2", 
      RowBox[{"\[Pi]", "/", "3"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"p3", ",", "0", ",", 
     RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.847432211558865*^9, 3.84743222664056*^9}, {
  3.847432450977446*^9, 3.847432454587249*^9}, {3.847433749247971*^9, 
  3.8474338010418997`*^9}, {3.847433836470118*^9, 3.847433866461369*^9}, {
  3.847434041738325*^9, 3.8474340494996862`*^9}, {3.847434289442521*^9, 
  3.847434295336844*^9}},
 CellLabel->
  "In[212]:=",ExpressionUUID->"829ab0e3-feed-43eb-a71a-8058e23ddaa4"],

Cell[BoxData[
 GraphicsBox[{{{}, {}, 
    TagBox[
     {RGBColor[0.368417, 0.506779, 0.709798], AbsoluteThickness[3], Opacity[
      1.], LineBox[CompressedData["
1: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
0KxsbeVUOFuIvrG2XPKnOfubcYi0rBC1mRZ5GtGscnx+0l4VIVLQ1AoS0PvP
XqRW9FFbiHq7gp7cpnneCwLbLRCi5ynzDgbSfGGPeFf1MiGq8O/cx6RZde7o
X3UzIYqoXnXnCp2/C7f7mcmWQlT+nrXSlGY1927qr70Q5e6aEmug858neGq5
xVmIrmjxGCtoVr9Y7928RYhUetSXltH1y1t1M3ppgBDx8EA6i2aNvuKMnFAh
OrqIz95J11uTSnkSdliIpNM21IvQesh/cvBr1zEh4tz3rTeh9aIVGiZmmSpE
IlMObwNpPWlXbTJWKhAirc9XPEtp/RU62zjFXREipxbV2mpfCnQmTEIGKoWo
c/EBzVpar7pIo6jhvhD5fPOclUfru/jDHDz/iRCJmujGxnrR43HTu9JfClEy
03t08z8/NH9n7ugTok3uki1faP+c5brVzRRnABX34dpB2n/tUe0tZhIMsDS4
dUliEwWyj9e+3i3JgKINMXEJtF/TgmG4R5YBCkXlLVtpf6dX6pAVOgxwbhND
6bYUdIjnGn7hMuBjXWrnQ2sK5DcprFZZSMd7xOj/sKQgY2yWV7wBA94Ymi2U
o/tL5orBNFcrBvjXlT58t5zWQ2OtiNh2Brjl2LY6cSgYfH99368gBoi/4zKm
6H5nNVH8uyuUAa/WOsM5uh8Ozz/z4eZeBtRUH/tapUqBfeqOer9EBnx2ZWdF
ylIg6qFy+FEJA7xaOouUBCS4RLDGq68wYGdgaKfGJAnlJyXCCsoZkGrdP6o6
RoJ7w7BXdA0DejQYgonfJFSzn8DCRgb43Gv5bvyZhB1DBxipfQyou5nY8ryZ
hIbZe/Ye/EbvL1tDwfAhCQo6gYOBA3R+pvKMUhtIeOi86f2qEXp+5f2/uP+R
oH53If47TQQ+mXCl3l0hoT3hXcxmHRHoUq7/6JlMgum8lUJ1XxH4nJpBlZnT
94l7+y6fABHY9b7ZxWsFCU7n/fsKgkSgrOyS3wwjej+KJ57ohotATusmDb0F
JGTJdZ2fHy8CFzTuCYbkSRiTCjcyKhUBw3z77kVfuXBTUBq27ocITNaK6aUc
5gJeYfr51KAIdK/+XVobxYXH0c9cXgyLwBVntcnu3Vz4NPEXbeSLQPqXyUX8
bVxgjZpLu0mLAvlwzrcrNlwI/dV92W+xKARTb5fck+YC9Z7Ze2CPKBTdWnjz
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
t7Y=
       "]]},
     Annotation[#, "Charting`Private`Tag$58442#1"]& ]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0, 0},
  DisplayFunction->Identity,
  Frame->{{True, True}, {True, True}},
  FrameLabel->{{None, None}, {None, None}},
  FrameStyle->GrayLevel[0],
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  ImageSize->Large,
  LabelStyle->Directive[Large, 
    GrayLevel[0], FontFamily -> "Palatino"],
  Method->{
   "DefaultBoundaryStyle" -> Automatic, 
    "DefaultGraphicsInteraction" -> {
     "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
      "Effects" -> {
       "Highlight" -> {"ratio" -> 2}, "HighlightPoint" -> {"ratio" -> 2}, 
        "Droplines" -> {
         "freeformCursorMode" -> True, 
          "placement" -> {"x" -> "All", "y" -> "None"}}}}, "DefaultMeshStyle" -> 
    AbsolutePointSize[6], "ScalingFunctions" -> None, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->
   NCache[{{0, 2 Pi}, {-13.71821231624079, 13.718220705929236`}}, {{
     0, 6.283185307179586}, {-13.71821231624079, 13.718220705929236`}}],
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.8474340504809427`*^9, {3.8474342911018744`*^9, 3.847434296136636*^9}},
 CellLabel->
  "Out[212]=",ExpressionUUID->"50e31714-b3b1-4402-9c08-12fa13007faa"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OGWp", "[", "k_", "]"}], ":=", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox["\[Pi]", "2"]], 
   SuperscriptBox["k", "2"], 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"PpIntegrand", "[", 
      RowBox[{"k", ",", "q", ",", "c3", ",", "p3", ",", "p2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"k", "-", "1"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"2", ",", 
         RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p3", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OGWc", "[", "k_", "]"}], ":=", 
  RowBox[{
   FractionBox["2", 
    SuperscriptBox["\[Pi]", "2"]], 
   SuperscriptBox["k", "2"], 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{"PcIntegrand", "[", 
      RowBox[{"k", ",", "q", ",", "c3", ",", "p3", ",", "p2"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"q", ",", 
       RowBox[{"Abs", "[", 
        RowBox[{"k", "-", "1"}], "]"}], ",", 
       RowBox[{"Min", "[", 
        RowBox[{"2", ",", 
         RowBox[{"k", "+", "1"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"c3", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p3", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"p2", ",", "0", ",", 
       RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<MonteCarlo\>\""}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.8474316991159763`*^9, 3.8474317400990477`*^9}, {
   3.847431866311894*^9, 3.847431875716937*^9}, {3.8474319861700163`*^9, 
   3.847432027705735*^9}, {3.847432234213599*^9, 3.8474322418170156`*^9}, {
   3.847432364688671*^9, 3.8474324103768063`*^9}, {3.847432457132312*^9, 
   3.847432487607045*^9}, {3.847432800980102*^9, 3.847432867783671*^9}, {
   3.847433882182939*^9, 3.847433883213655*^9}, {3.847433934828741*^9, 
   3.8474339873364077`*^9}, {3.847434470504199*^9, 3.847434496099268*^9}, 
   3.847434627018051*^9},
 CellLabel->
  "In[218]:=",ExpressionUUID->"7949304e-8739-4f36-b4e4-893c578b9028"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"OGWp", "[", 
   RowBox[{"1", "/", "2"}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.84743286928257*^9, 3.8474328720891123`*^9}, {
  3.847433990831917*^9, 3.84743399166424*^9}, {3.847434487647357*^9, 
  3.8474344877467127`*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"2b10e737-c34c-45e1-89f1-ddbe75a711f3"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "slwcon", 
   "\"Numerical integration converging too slowly; suspect one of the \
following: singularity, value of the integration is 0, highly oscillatory \
integrand, or WorkingPrecision too small.\"", 2, 220, 24, 
   29180949853041037087, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.84743287840396*^9, {3.847433946703498*^9, 3.847434000014223*^9}, {
   3.847434489058861*^9, 3.8474345029532948`*^9}},
 CellLabel->
  "During evaluation of \
In[220]:=",ExpressionUUID->"d588300f-8f3d-41eb-85c8-02e010abd485"],

Cell[BoxData[
 TemplateBox[{
  "NIntegrate", "eincr", 
   "\"The global error of the strategy GlobalAdaptive has increased more than \
\\!\\(\\*RowBox[{\\\"2000\\\"}]\\) times. The global error is expected to \
decrease monotonically after a number of integrand evaluations. Suspect one \
of the following: the working precision is insufficient for the specified \
precision goal; the integrand is highly oscillatory or it is not a \
(piecewise) smooth function; or the true value of the integral is 0. \
Increasing the value of the GlobalAdaptive option MaxErrorIncreases might \
lead to a convergent numerical integration. NIntegrate obtained \
\\!\\(\\*RowBox[{\\\"-\\\", \\\"30.482823310342294`\\\"}]\\) and \
\\!\\(\\*RowBox[{\\\"0.23427389445078523`\\\"}]\\) for the integral and error \
estimates.\"", 2, 220, 25, 29180949853041037087, "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.84743287840396*^9, {3.847433946703498*^9, 3.847434000014223*^9}, {
   3.847434489058861*^9, 3.847434510673359*^9}},
 CellLabel->
  "During evaluation of \
In[220]:=",ExpressionUUID->"5c964168-00af-4359-8fd2-0ce8b2124195"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"13.379921`", ",", 
   RowBox[{"-", "1.5442778692820631`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.847433058234125*^9, {3.8474339467195*^9, 3.847434000043696*^9}, {
   3.847434489075074*^9, 3.847434510711738*^9}},
 CellLabel->
  "Out[220]=",ExpressionUUID->"34471233-dac5-4c22-9320-7b95b501ef56"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{2169, 1235},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"12.3 for Mac OS X x86 (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"43885c5d-18e7-4ff0-a219-1651e1261f18"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 203, 4, 37, "Input",ExpressionUUID->"bd0b2cf0-3f9a-4432-9e51-1cb39d5226b0"],
Cell[CellGroupData[{
Cell[786, 28, 1584, 40, 116, "Input",ExpressionUUID->"fd8d32e2-783a-4b87-a6da-07e4c9659bed"],
Cell[2373, 70, 1034, 28, 99, "Output",ExpressionUUID->"8015f19a-5da3-4569-89df-1f15797fc7a7"],
Cell[3410, 100, 1026, 28, 99, "Output",ExpressionUUID->"cb3e86cf-c6fa-469d-b4a8-8c3df184c098"],
Cell[4439, 130, 1026, 28, 99, "Output",ExpressionUUID->"62b278b4-5ba8-4d05-9478-501023cac7d8"]
}, Open  ]],
Cell[5480, 161, 636, 17, 37, "Input",ExpressionUUID->"3aef267d-5f05-4f87-b9fa-fdb5c3d7ac0f"],
Cell[CellGroupData[{
Cell[6141, 182, 472, 8, 37, "Input",ExpressionUUID->"d17213a7-a72c-4410-8706-a13d01631666"],
Cell[6616, 192, 476, 10, 42, "Output",ExpressionUUID->"dfe33468-06b3-4901-b28a-720ef0f74345"]
}, Open  ]],
Cell[7107, 205, 1368, 40, 90, "Input",ExpressionUUID->"09d69124-72de-49b8-a945-f02d9a91a5cd"],
Cell[CellGroupData[{
Cell[8500, 249, 3388, 88, 263, "Input",ExpressionUUID->"f1191cc7-082e-4868-bac9-94433456a953"],
Cell[11891, 339, 768, 22, 53, "Output",ExpressionUUID->"cfda8ab4-c316-47b3-ad19-6064c5d53962"],
Cell[12662, 363, 2871, 87, 127, "Output",ExpressionUUID->"4da83ce2-bfb6-4565-8794-5d02329b8e10"],
Cell[15536, 452, 2888, 87, 127, "Output",ExpressionUUID->"a9d0f63a-14c7-4c53-b389-ada009c4fe9d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18461, 544, 206, 3, 37, "Input",ExpressionUUID->"68a8f020-a6c6-491d-b756-886a5cff8dfc"],
Cell[18670, 549, 626, 18, 53, "Output",ExpressionUUID->"1c00ca1d-3488-430c-925a-7adfdbae3f50"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19333, 572, 692, 16, 64, "Input",ExpressionUUID->"2d7970fd-a99a-42ee-b82b-ecf57e7f62f8"],
Cell[20028, 590, 5487, 173, 275, "Output",ExpressionUUID->"3a0ab502-819e-453d-87b2-28db2aa72e46"],
Cell[25518, 765, 370, 7, 42, "Output",ExpressionUUID->"b1b94c7b-f98b-4bbf-a1b4-d81acd0f104d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25925, 777, 644, 18, 40, "Input",ExpressionUUID->"4350e013-0b4c-431a-8ad1-98f97004ae9a"],
Cell[26572, 797, 19989, 617, 1072, "Output",ExpressionUUID->"68663c12-2ba1-470e-9371-fd7261fec87e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46598, 1419, 205, 3, 37, "Input",ExpressionUUID->"6e357362-9584-45df-b1f3-5078385b4d47"],
Cell[46806, 1424, 20228, 610, 417, "Output",ExpressionUUID->"c08143b8-93cb-40ce-be10-c71db1658bc0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67071, 2039, 284, 5, 37, "Input",ExpressionUUID->"50f7a899-c53e-4c30-bb0c-11eeaebde5a1"],
Cell[67358, 2046, 375, 9, 43, "Output",ExpressionUUID->"33fee35d-ed40-403a-8950-0a99e45c82f1"]
}, Open  ]],
Cell[67748, 2058, 808, 24, 64, "Input",ExpressionUUID->"c37d9f10-bb43-41fd-b7e9-950e4aff94d7"],
Cell[68559, 2084, 344, 9, 37, "Input",ExpressionUUID->"4f00d8a5-6efe-41c5-a4f9-07bce79b40cc"],
Cell[CellGroupData[{
Cell[68928, 2097, 349, 7, 64, "Input",ExpressionUUID->"b31f6306-04d6-418b-b880-4befd06f081b"],
Cell[69280, 2106, 348, 8, 46, "Output",ExpressionUUID->"d4aa93ee-4bc0-4dcc-b319-9d9092b0aeb0"],
Cell[69631, 2116, 305, 6, 42, "Output",ExpressionUUID->"4529102b-b63c-4023-9e2d-84eb48a69f0c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69973, 2127, 672, 14, 37, "Input",ExpressionUUID->"f3f685d1-b0ab-4a2c-8ab0-acf135923e14"],
Cell[70648, 2143, 2523, 71, 107, "Output",ExpressionUUID->"a85f6b48-29ed-4574-83ca-4927f7af00cf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73208, 2219, 623, 14, 37, "Input",ExpressionUUID->"6a542a77-06d9-4cac-83f9-5aee68d08313"],
Cell[73834, 2235, 2638, 78, 119, "Output",ExpressionUUID->"200cbbef-9800-45cb-b502-41db9da6b401"]
}, Open  ]],
Cell[76487, 2316, 1381, 41, 89, "Input",ExpressionUUID->"41a4a481-13d7-42cb-84a0-564f820fe016"],
Cell[CellGroupData[{
Cell[77893, 2361, 269, 6, 37, "Input",ExpressionUUID->"5c67bc5e-4f37-4b5d-a71e-6b5dbcd43feb"],
Cell[78165, 2369, 244, 5, 46, "Output",ExpressionUUID->"cb81bf9f-e52d-4817-b0c3-00a558c8fe3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78446, 2379, 459, 12, 37, "Input",ExpressionUUID->"343918e7-2cb6-4936-a908-a9040269a070"],
Cell[78908, 2393, 1385, 44, 60, "Output",ExpressionUUID->"f727acb7-159e-4dfc-81ab-4936944d4ff6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80330, 2442, 455, 11, 37, "Input",ExpressionUUID->"3e4b1e93-ce6d-4e4f-a603-3b954b1c9452"],
Cell[80788, 2455, 798, 25, 59, "Output",ExpressionUUID->"4cff08c0-df35-42dc-892a-935b40e709e2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81623, 2485, 461, 13, 37, "Input",ExpressionUUID->"47d00020-73b3-4bc0-8299-6f208cf81fba"],
Cell[82087, 2500, 660, 20, 53, "Output",ExpressionUUID->"40b79d1b-34f2-4f8f-8655-32c02fea4c5b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82784, 2525, 456, 12, 37, "Input",ExpressionUUID->"10826bc6-fb18-4451-9998-552e1f69faf7"],
Cell[83243, 2539, 1413, 43, 59, "Output",ExpressionUUID->"7afd490f-94d2-4db1-811e-a0ae638a2399"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84693, 2587, 458, 12, 37, "Input",ExpressionUUID->"5e8432fc-ac11-4e72-a0e4-0118b2230cd0"],
Cell[85154, 2601, 714, 20, 42, "Output",ExpressionUUID->"72bc527d-64e7-40d9-a38e-0e999040083e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85905, 2626, 463, 13, 37, "Input",ExpressionUUID->"bba223c6-81e2-4b2e-8868-39b4f9730b55"],
Cell[86371, 2641, 733, 20, 43, "Output",ExpressionUUID->"56e46891-fbb2-4dc4-b146-ee6118bef66e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87141, 2666, 151, 3, 67, "Subsection",ExpressionUUID->"7b00873b-98fb-426e-b724-df3e6fb0dbc3"],
Cell[87295, 2671, 203, 4, 37, "Input",ExpressionUUID->"766bd9ef-ed60-41fc-bf5d-40a284298bb9"],
Cell[CellGroupData[{
Cell[87523, 2679, 512, 13, 37, "Input",ExpressionUUID->"d699a176-a0bc-4ab6-a106-09bb6c305204"],
Cell[88038, 2694, 478, 12, 42, "Output",ExpressionUUID->"66e471ca-86fc-414a-bbf7-2db6466d8fff"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88553, 2711, 1620, 44, 95, "Input",ExpressionUUID->"2a6eb6be-c57e-405c-94a9-31ca53c574bb"],
Cell[90176, 2757, 1999, 60, 161, "Output",ExpressionUUID->"a1b75ad3-6438-4d99-a70e-46c734641d66"]
}, Open  ]],
Cell[92190, 2820, 808, 24, 64, "Input",ExpressionUUID->"85ee119c-054e-4c53-8437-5e064f9db1b1"],
Cell[93001, 2846, 3014, 85, 150, "Input",ExpressionUUID->"ff514563-d66e-4a05-a946-b8b4e8878e5e"],
Cell[96018, 2933, 1452, 44, 119, "Input",ExpressionUUID->"0c30d520-33b9-4cf3-b1f3-dedefaf587cf"],
Cell[CellGroupData[{
Cell[97495, 2981, 1403, 43, 147, "Input",ExpressionUUID->"7f662e7a-0ac4-40d5-b9b8-401b808872b8"],
Cell[98901, 3026, 337, 6, 42, "Output",ExpressionUUID->"171dd28b-3d2b-4cf1-b7a8-2044346a21ba"],
Cell[99241, 3034, 338, 6, 42, "Output",ExpressionUUID->"db4907dd-4db0-4551-b8e8-099ebc858ea3"],
Cell[99582, 3042, 338, 6, 42, "Output",ExpressionUUID->"d91edd79-8e0b-4612-954b-ee0d695cbb2d"],
Cell[99923, 3050, 338, 6, 42, "Output",ExpressionUUID->"fb74253d-fad8-4471-9419-a519159a2347"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100298, 3061, 469, 11, 37, "Input",ExpressionUUID->"803fb4ac-6513-49bc-b391-c6c9320f250e"],
Cell[100770, 3074, 482, 7, 43, "Output",ExpressionUUID->"3887f067-9395-4a20-be38-305e03fb4f78"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101289, 3086, 1471, 45, 90, "Input",ExpressionUUID->"13e2129c-337a-44fd-9812-7552da9e4144"],
Cell[102763, 3133, 1194, 34, 83, "Output",ExpressionUUID->"80f46c47-c176-45dd-a7cc-ef65f135182b"],
Cell[103960, 3169, 1051, 30, 96, "Output",ExpressionUUID->"fff012e4-52d7-4b37-bcac-56d7867bed98"],
Cell[105014, 3201, 423, 8, 48, "Output",ExpressionUUID->"88851929-ade4-4886-9eb1-d0cfa77054c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105474, 3214, 1853, 55, 116, "Input",ExpressionUUID->"63513eee-8789-4232-93e3-e5d8b4a8c771"],
Cell[107330, 3271, 3357, 105, 150, "Output",ExpressionUUID->"d6bf00c6-b414-40db-838f-5ff4d68ce5ec"],
Cell[110690, 3378, 1632, 46, 77, "Output",ExpressionUUID->"38414932-5fe9-467f-ba7f-fc5f4908a9a2"],
Cell[112325, 3426, 2506, 77, 77, "Output",ExpressionUUID->"374721a2-12e2-47c7-a0e2-7d2bf4c4499f"],
Cell[114834, 3505, 1491, 42, 77, "Output",ExpressionUUID->"0f6bd38f-1608-4bed-a545-55565609305e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116362, 3552, 648, 14, 116, "Input",ExpressionUUID->"af1eb922-7537-49d4-a7b1-b1377bed7ca7"],
Cell[117013, 3568, 296, 4, 42, "Output",ExpressionUUID->"48fa2394-fc23-400a-804c-fd953e92a10d"],
Cell[117312, 3574, 315, 5, 42, "Output",ExpressionUUID->"c68e29b4-1b82-484d-8473-b8aeb530b0d0"],
Cell[117630, 3581, 316, 5, 59, "Output",ExpressionUUID->"bd8163dc-f98a-4761-8054-4820c017e934"],
Cell[117949, 3588, 332, 6, 59, "Output",ExpressionUUID->"01fabb91-75c9-4b63-b88d-ed25c7b7f9e9"]
}, Open  ]],
Cell[118296, 3597, 3801, 113, 154, "Input",ExpressionUUID->"27ce2a7e-27c1-43b9-8eb8-739674c6fa7a"],
Cell[122100, 3712, 1587, 41, 64, "Input",ExpressionUUID->"84542494-bdaf-4842-a6be-5b2eb501658f"],
Cell[CellGroupData[{
Cell[123712, 3757, 738, 18, 37, "Input",ExpressionUUID->"bd20813d-cdeb-492b-beda-69e606b3b23c"],
Cell[124453, 3777, 8620, 163, 470, "Output",ExpressionUUID->"382543a2-9367-4b9a-bd4e-9e5f04c273b4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133110, 3945, 831, 20, 37, "Input",ExpressionUUID->"829ab0e3-feed-43eb-a71a-8058e23ddaa4"],
Cell[133944, 3967, 10629, 197, 483, "Output",ExpressionUUID->"50e31714-b3b1-4402-9c08-12fa13007faa"]
}, Open  ]],
Cell[144588, 4167, 2429, 64, 112, "Input",ExpressionUUID->"7949304e-8739-4f36-b4e4-893c578b9028"],
Cell[CellGroupData[{
Cell[147042, 4235, 367, 8, 37, "Input",ExpressionUUID->"2b10e737-c34c-45e1-89f1-ddbe75a711f3"],
Cell[147412, 4245, 586, 13, 35, "Message",ExpressionUUID->"d588300f-8f3d-41eb-85c8-02e010abd485"],
Cell[148001, 4260, 1139, 20, 78, "Message",ExpressionUUID->"5c964168-00af-4359-8fd2-0ce8b2124195"],
Cell[149143, 4282, 341, 8, 42, "Output",ExpressionUUID->"34471233-dac5-4c22-9320-7b95b501ef56"]
}, Open  ]]
}, Open  ]]
}
]
*)

